<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>最小化安装Centos7 编译安装Nginx PHP7 MySQL5.7 Redis3.2 swoole1.8 | Mustang Blog</title><link rel="stylesheet" type="text/css" href="//fonts.css.network/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.2.0"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=1.2.0"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">最小化安装Centos7 编译安装Nginx PHP7 MySQL5.7 Redis3.2 swoole1.8</h1><a id="logo" href="/.">Mustang Blog</a><p class="description">天行健，君子以自强不息；地势坤，君子以厚德载物</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">最小化安装Centos7 编译安装Nginx PHP7 MySQL5.7 Redis3.2 swoole1.8</h1><div class="post-meta">Jun 27, 2016</div><div class="post-content"><p>技术更新，好久没有更新开发环境了，根据官方文档和网友的分享吧工作环境编译了一遍，过程分享给大家。<br>centos 7最小化安装（CentOS-7-x86_64-Minimal-1511.iso）</p>
<p>yum search ifconfig 不然自己ip都看不到<br>yum install net-tools.x86_64 wget</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cd /etc/yum.repos.d/</span></span><br><span class="line"><span class="comment"># cp CentOS-Base.repo CentOS-Base.repo.backup</span></span><br><span class="line"><span class="comment"># wget -O CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</span></span><br></pre></td></tr></table></figure>
<h2 id="安装系统包"><a href="#安装系统包" class="headerlink" title="安装系统包"></a>安装系统包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># yum -y install wget python-lockfile lrzsz bison vim cmake unzip gcc gcc-c++ make automake autoconf curl curl-devel libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel e2fsprogs e2fsprogs-devel libidn libidn-devel openssl openssl-devel openldap openldap-devel openldap-clients openldap-servers libevent libevent-devel net-tools nss_ldap pcre-devel gd kernel kernel-headers perl php-common php-gd libtool* patch libmcrypt libmcrypt-devel</span></span><br></pre></td></tr></table></figure>
<p>如果没有mkdir命令，yum install python-lockfile<br>如果 libmcrypt libmcrypt-devel 没找到</p>
<p>下载libmcrypt(<a href="https://sourceforge.net/projects/mcrypt/files/Libmcrypt/2.5.8/libmcrypt-2.5.8.tar.gz/download" target="_blank" rel="noopener">https://sourceforge.net/projects/mcrypt/files/Libmcrypt/2.5.8/libmcrypt-2.5.8.tar.gz/download</a>)</p>
<p>下载mash(<a href="https://sourceforge.net/projects/mhash/" target="_blank" rel="noopener">https://sourceforge.net/projects/mhash/</a>)</p>
<p>下载mcrypt(<a href="https://sourceforge.net/projects/mcrypt/files/latest/download" target="_blank" rel="noopener">https://sourceforge.net/projects/mcrypt/files/latest/download</a>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar xzf libmcrypt-2.5.8.tar.gz</span></span><br><span class="line"><span class="comment"># cd libmcrypt-2.5.8</span></span><br><span class="line"><span class="comment"># ./configure</span></span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># tar xzf mhash-0.9.9.9.tar.gz</span></span><br><span class="line"><span class="comment"># cd mhash-0.9.9.9</span></span><br><span class="line"><span class="comment"># ./configure</span></span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># tar xzf mcrypt-2.6.8.tar.gz</span></span><br><span class="line"><span class="comment"># cd mcrypt-2.6.8</span></span><br><span class="line"><span class="comment"># LD_LIBRARY_PATH=/usr/local/lib ./configure</span></span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br></pre></td></tr></table></figure>
<h2 id="安装Nginx"><a href="#安装Nginx" class="headerlink" title="安装Nginx"></a>安装Nginx</h2><p>官网下载最新版本(<a href="http://nginx.org/" target="_blank" rel="noopener">http://nginx.org/</a>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar xzf nginx-1.10.1.tar.gz</span></span><br><span class="line"><span class="comment"># cd nginx-1.10.1</span></span><br><span class="line"><span class="comment"># ./configure --prefix=/usr/local/nginx --user=www --group=www --with-http_stub_status_module --with-http_ssl_module --pid-path=/usr/local/nginx/nginx.pid --conf-path=/usr/local/nginx/nginx.conf</span></span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br></pre></td></tr></table></figure>
<p>nginx启动的shell： /etc/rc.d/init.d/nginx<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#! /bin/bash</span></span><br><span class="line"><span class="comment"># chkconfig: 35 85 15</span></span><br><span class="line"><span class="comment"># description: Nginx is an HTTP(S) server, HTTP(S) reverse</span></span><br><span class="line"><span class="built_in">set</span> -e</span><br><span class="line">PATH=/usr/<span class="built_in">local</span>/sbin:/usr/<span class="built_in">local</span>/bin:/sbin:/bin:/usr/sbin:/usr/bin</span><br><span class="line">DESC=<span class="string">"nginx daemon"</span></span><br><span class="line">NAME=nginx</span><br><span class="line">DAEMON=/usr/<span class="built_in">local</span>/nginx/sbin/<span class="variable">$NAME</span></span><br><span class="line">SCRIPTNAME=/etc/init.d/<span class="variable">$NAME</span></span><br><span class="line"><span class="built_in">test</span> -x <span class="variable">$DAEMON</span> || <span class="built_in">exit</span> 0</span><br><span class="line"><span class="function"><span class="title">d_start</span></span>()&#123;</span><br><span class="line">    <span class="variable">$DAEMON</span> || <span class="built_in">echo</span> -n <span class="string">" already running"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">d_stop</span></span>() &#123;</span><br><span class="line">    <span class="variable">$DAEMON</span> -s quit || <span class="built_in">echo</span> -n <span class="string">" not running"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">d_reload</span></span>() &#123;</span><br><span class="line">    <span class="variable">$DAEMON</span> -s reload || <span class="built_in">echo</span> -n <span class="string">" counld not reload"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">start)</span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">"Starting <span class="variable">$DESC</span>:<span class="variable">$NAME</span>"</span></span><br><span class="line">    d_start</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"."</span></span><br><span class="line">;;</span><br><span class="line">stop)</span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">"Stopping <span class="variable">$DESC</span>:<span class="variable">$NAME</span>"</span></span><br><span class="line">    d_stop</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"."</span></span><br><span class="line">;;</span><br><span class="line">reload)</span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">"Reloading <span class="variable">$DESC</span> configuration..."</span></span><br><span class="line">    d_reload</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"reloaded."</span></span><br><span class="line">;;</span><br><span class="line">restart)</span><br><span class="line">    <span class="built_in">echo</span> -n <span class="string">"Restarting <span class="variable">$DESC</span>: <span class="variable">$NAME</span>"</span></span><br><span class="line">    d_stop</span><br><span class="line">    sleep 2</span><br><span class="line">    d_start</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"."</span></span><br><span class="line">;;</span><br><span class="line">*)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Usage: <span class="variable">$SCRIPTNAME</span> &#123;start|stop|restart|reload&#125;"</span> &gt;&amp;2</span><br><span class="line">    <span class="built_in">exit</span> 3</span><br><span class="line">;;</span><br><span class="line"><span class="keyword">esac</span></span><br><span class="line"><span class="built_in">exit</span> 0</span><br></pre></td></tr></table></figure></p>
<p>启动 nginx</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># service nginx start</span></span><br></pre></td></tr></table></figure>
<h2 id="编译PHP"><a href="#编译PHP" class="headerlink" title="编译PHP"></a>编译PHP</h2><p>php.net 官网下载PHP7(<a href="http://php.net/downloads.php" target="_blank" rel="noopener">http://php.net/downloads.php</a>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar xzf php-7.0.8.tar.gz</span></span><br><span class="line"><span class="comment"># cd php-7.0.8</span></span><br><span class="line"><span class="comment"># ./configure --prefix=/usr/local/php7 \</span></span><br><span class="line">--with-config-file-path=/usr/<span class="built_in">local</span>/php7/etc \</span><br><span class="line">--with-config-file-scan-dir=/usr/<span class="built_in">local</span>/php7/etc/php.d \</span><br><span class="line">--with-mcrypt=/usr/include \</span><br><span class="line">--<span class="built_in">enable</span>-mysqlnd \</span><br><span class="line">--with-mysqli \</span><br><span class="line">--with-pdo-mysql \</span><br><span class="line">--<span class="built_in">enable</span>-fpm \</span><br><span class="line">--with-fpm-user=www \</span><br><span class="line">--with-fpm-group=www \</span><br><span class="line">--with-gd \</span><br><span class="line">--with-iconv \</span><br><span class="line">--with-zlib \</span><br><span class="line">--<span class="built_in">enable</span>-xml \</span><br><span class="line">--<span class="built_in">enable</span>-shmop \</span><br><span class="line">--<span class="built_in">enable</span>-sysvsem \</span><br><span class="line">--<span class="built_in">enable</span>-inline-optimization \</span><br><span class="line">--<span class="built_in">enable</span>-mbregex \</span><br><span class="line">--<span class="built_in">enable</span>-mbstring \</span><br><span class="line">--<span class="built_in">enable</span>-ftp \</span><br><span class="line">--<span class="built_in">enable</span>-gd-native-ttf \</span><br><span class="line">--with-openssl \</span><br><span class="line">--<span class="built_in">enable</span>-pcntl \</span><br><span class="line">--<span class="built_in">enable</span>-sockets \</span><br><span class="line">--with-xmlrpc \</span><br><span class="line">--<span class="built_in">enable</span>-zip \</span><br><span class="line">--<span class="built_in">enable</span>-soap \</span><br><span class="line">--without-pear \</span><br><span class="line">--with-gettext \</span><br><span class="line">--<span class="built_in">enable</span>-session \</span><br><span class="line">--with-curl \</span><br><span class="line">--with-jpeg-dir \</span><br><span class="line">--with-freetype-dir \</span><br><span class="line">--<span class="built_in">enable</span>-opcache</span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br><span class="line"><span class="comment"># cp php.ini-production  /usr/local/php7/etc/php.ini</span></span><br><span class="line"><span class="comment"># cp sapi/fpm/init.d.php-fpm /etc/init.d/php-fpm</span></span><br><span class="line"><span class="comment"># chmod +x /etc/init.d/php-fpm</span></span><br><span class="line"><span class="comment"># chkconfig --add php-fpm</span></span><br><span class="line"><span class="comment"># chkconfig php-fpm on</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># cd /usr/local/php7/etc</span></span><br><span class="line"><span class="comment"># cp php-fpm.conf.default php-fpm.conf</span></span><br><span class="line"><span class="comment"># cp php-fpm.d/www.conf.default php-fpm.d/www.conf</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># service php-fpm start</span></span><br></pre></td></tr></table></figure>
<p>此时应该可以通过 验证PHP的安装信息了<br>修改nginx的php相关配置<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">        location ~ \.php &#123;</span><br><span class="line">            root           /media/psf/Home/Documents/website;</span><br><span class="line">               proxy_buffer_size  128k;</span><br><span class="line">               proxy_buffers   32 32k;</span><br><span class="line">               proxy_busy_buffers_size 128k;</span><br><span class="line">               fastcgi_pass    127.0.0.1:9000;</span><br><span class="line">               fastcgi_index   index.php;</span><br><span class="line">               fastcgi_param  SCRIPT_FILENAME   <span class="variable">$document_root</span><span class="variable">$fastcgi_script_name</span>;</span><br><span class="line">               fastcgi_param  PHP_VALUE        open_basedir=<span class="variable">$document_root</span>:/tmp/:/proc/;</span><br><span class="line">               include fastcgi_params;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="编译MySQL"><a href="#编译MySQL" class="headerlink" title="编译MySQL"></a>编译MySQL</h2><p>mysql 官网下载(<a href="http://dev.mysql.com/downloads/mysql/" target="_blank" rel="noopener">http://dev.mysql.com/downloads/mysql/</a>)<br>网页下面的 Select Platform 选择 Source Code，<br>下载网页下面的 mysql-5.7.13.tar.gz mysql-boost-5.7.13.tar.gz<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># groupadd mysql</span></span><br><span class="line"><span class="comment"># useradd -g mysql mysql</span></span><br><span class="line"><span class="comment"># usermod -s /bin/false mysql</span></span><br><span class="line"><span class="comment"># mkdir -p /data/mysql</span></span><br><span class="line"><span class="comment"># chown mysql:mysql /data/mysql</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># tar xzf mysql-boost-5.7.13.tar.gz</span></span><br><span class="line"><span class="comment"># tar xzf mysql-5.7.13.tar.gz</span></span><br><span class="line"><span class="comment"># cd mysql-5.7.13</span></span><br></pre></td></tr></table></figure></p>
<p>从MySQL 5.7.5开始Boost库是必需的<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># cmake . -DCMAKE_INSTALL_PREFIX=/usr/local/mysql \</span></span><br><span class="line">-DMYSQL_DATADIR=/data/mysql \</span><br><span class="line">-DWITH_BOOST=boost \</span><br><span class="line">-DSYSCONFDIR=/usr/<span class="built_in">local</span>/mysql/etc \</span><br><span class="line">-DWITH_INNOBASE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_PARTITION_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_FEDERATED_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_BLACKHOLE_STORAGE_ENGINE=1 \</span><br><span class="line">-DWITH_MYISAM_STORAGE_ENGINE=1 \</span><br><span class="line">-DENABLED_LOCAL_INFILE=1 \</span><br><span class="line">-DENABLE_DTRACE=0 \</span><br><span class="line">-DDEFAULT_CHARSET=utf8mb4 \</span><br><span class="line">-DDEFAULT_COLLATION=utf8mb4_general_ci \</span><br><span class="line">-DWITH_EMBEDDED_SERVER=1</span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br><span class="line"><span class="comment"># cp /usr/local/mysql/support-files/mysql.server /etc/init.d/mysqld</span></span><br><span class="line"><span class="comment"># chmod +x /etc/init.d/mysqld</span></span><br><span class="line"><span class="comment"># chkconfig --add mysqld</span></span><br><span class="line"><span class="comment"># chkconfig mysqld on</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># /usr/local/mysql/bin/mysqld --initialize-insecure --user=mysql --basedir=/usr/local/mysql/ --datadir=/data/mysql/</span></span><br><span class="line"><span class="comment"># mkdir /var/run/mariadb</span></span><br><span class="line"><span class="comment"># chown mysql:mysql -R /var/run/mariadb</span></span><br><span class="line"><span class="comment"># mkdir /var/log/mariadb</span></span><br><span class="line"><span class="comment"># chown mysql:mysql -R /var/log/mariadb</span></span><br><span class="line"><span class="comment"># service mysqld start</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># /usr/local/mysql/bin/mysql -uroot -p</span></span><br><span class="line">mysql&gt; ALTER USER <span class="string">'root'</span>@<span class="string">'localhost'</span> IDENTIFIED BY <span class="string">'root'</span>;</span><br><span class="line">mysql&gt; flush privileges;</span><br><span class="line">mysql&gt; <span class="built_in">exit</span>;</span><br></pre></td></tr></table></figure></p>
<p>此时可以安装一个phpMyAdmin测试一下数据库了。</p>
<h2 id="安装redis"><a href="#安装redis" class="headerlink" title="安装redis"></a>安装redis</h2><p>官网：<a href="http://redis.io/" target="_blank" rel="noopener">http://redis.io/</a><br>下载 redis 目前最新版是：redis-3.2.1.tar.gz<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar xzf redis-3.2.1.tar.gz</span></span><br><span class="line"><span class="comment"># cd redis-3.2.1</span></span><br><span class="line"><span class="comment"># make PREFIX=/usr/local/redis install</span></span><br><span class="line"><span class="comment"># mkdir /usr/local/redis/etc</span></span><br><span class="line"><span class="comment"># cp redis.conf /usr/local/redis/etc/6379.conf</span></span><br><span class="line"><span class="comment"># mkdir /data/redis</span></span><br></pre></td></tr></table></figure></p>
<p>修改配置文件/usr/local/redis/etc/6379.conf<br>dir 参数改为 /data/redis<br>daemonize 参数改为 yes</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># vim /etc/init.d/redis</span></span><br></pre></td></tr></table></figure>
<p>添加启动shell<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/sh</span></span><br><span class="line"><span class="comment"># chkconfig: 2345 10 90</span></span><br><span class="line"><span class="comment"># description: Start and Stop redis</span></span><br><span class="line"> </span><br><span class="line">REDISPORT=6379</span><br><span class="line">EXEC=/usr/<span class="built_in">local</span>/redis/bin/redis-server</span><br><span class="line">REDIS_CLI=/usr/<span class="built_in">local</span>/redis/bin/redis-cli</span><br><span class="line"> </span><br><span class="line">PIDFILE=/data/redis/6379.pid</span><br><span class="line">CONF=<span class="string">"/usr/local/redis/etc/6379.conf"</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">case</span> <span class="string">"<span class="variable">$1</span>"</span> <span class="keyword">in</span></span><br><span class="line">    start)</span><br><span class="line">        <span class="keyword">if</span> [ -f <span class="variable">$PIDFILE</span> ]</span><br><span class="line">        <span class="keyword">then</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"<span class="variable">$PIDFILE</span> exists, process is already running or crashed."</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"Starting Redis server..."</span></span><br><span class="line">                <span class="variable">$EXEC</span> <span class="variable">$CONF</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        <span class="keyword">if</span> [ <span class="string">"$?"</span>=<span class="string">"0"</span> ]</span><br><span class="line">        <span class="keyword">then</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"Redis is running..."</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        ;;</span><br><span class="line">    stop)</span><br><span class="line">        <span class="keyword">if</span> [ ! -f <span class="variable">$PIDFILE</span> ]</span><br><span class="line">        <span class="keyword">then</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"<span class="variable">$PIDFILE</span> exists, process is not running."</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">                PID=$(cat <span class="variable">$PIDFILE</span>)</span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"Stopping..."</span></span><br><span class="line">               <span class="variable">$REDIS_CLI</span> -p <span class="variable">$REDISPORT</span>  SHUTDOWN</span><br><span class="line">                sleep 2</span><br><span class="line">               <span class="keyword">while</span> [ -x <span class="variable">$PIDFILE</span> ]</span><br><span class="line">               <span class="keyword">do</span></span><br><span class="line">                        <span class="built_in">echo</span> <span class="string">"Waiting for Redis to shutdown..."</span></span><br><span class="line">                       sleep 1</span><br><span class="line">                <span class="keyword">done</span></span><br><span class="line">                <span class="built_in">echo</span> <span class="string">"Redis stopped"</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">        ;;</span><br><span class="line">    restart|force-reload)</span><br><span class="line">        <span class="variable">$&#123;0&#125;</span> stop</span><br><span class="line">        <span class="variable">$&#123;0&#125;</span> start</span><br><span class="line">        ;;</span><br><span class="line">    *)</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">"Usage: /etc/init.d/redis &#123;start|stop|restart|force-reload&#125;"</span> &gt;&amp;2</span><br><span class="line">    <span class="built_in">exit</span> 1</span><br><span class="line"><span class="keyword">esac</span></span><br></pre></td></tr></table></figure></p>
<p>启动redis服务<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># service redis start</span></span><br></pre></td></tr></table></figure></p>
<p>redis安装完成，如果需要多个redis服务，可以cp多个配置文件和多个redis服务器脚本</p>
<h2 id="安装redis-for-php模块"><a href="#安装redis-for-php模块" class="headerlink" title="安装redis for php模块"></a>安装redis for php模块</h2><p>官网下载(<a href="https://github.com/phpredis/phpredis" target="_blank" rel="noopener">https://github.com/phpredis/phpredis</a>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">unzip phpredis-develop.zip</span><br><span class="line"><span class="built_in">cd</span> phpredis-develop</span><br><span class="line">/usr/<span class="built_in">local</span>/php7/bin/phpize</span><br><span class="line">./configure --with-php-config=/usr/<span class="built_in">local</span>/php7/bin/php-config</span><br><span class="line">make</span><br><span class="line">make install</span><br><span class="line">vim /usr/<span class="built_in">local</span>/php7/etc/php.ini +</span><br></pre></td></tr></table></figure>
<p>添加一行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extension=redis.so</span><br></pre></td></tr></table></figure>
<p>重启php-fpm<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service php-fpm restart</span><br></pre></td></tr></table></figure></p>
<p>此时查看phpinfo的页面，应该可以看到redis模块的信息</p>
<h2 id="安装swoole模块"><a href="#安装swoole模块" class="headerlink" title="安装swoole模块"></a>安装swoole模块</h2><p>官网下载(<a href="https://github.com/swoole/swoolw-src/releases" target="_blank" rel="noopener">https://github.com/swoole/swoolw-src/releases</a>)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># mv 1.8.6-stable.tar.gz swoole-1.8.6-stable.tar.gz</span></span><br><span class="line"><span class="comment"># tar xzf swoole-1.8.6-stable.tar.gz</span></span><br><span class="line"><span class="comment"># cd swoole-src-1.8.6-stable/</span></span><br><span class="line"><span class="comment"># ./configure --with-php-config=/usr/local/php7/bin/php-config</span></span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br><span class="line"><span class="comment"># vim /usr/local/php7/etc/php.ini +</span></span><br></pre></td></tr></table></figure>
<p>添加一行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">extension=swoole.so</span><br></pre></td></tr></table></figure></p>
<p>重启php-fpm<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service php-fpm restart</span><br></pre></td></tr></table></figure></p>
<p>此时查看phpinfo的页面，应该可以看到swoole模块的信息</p>
<h2 id="安装-Node-js"><a href="#安装-Node-js" class="headerlink" title="安装 Node.js"></a>安装 Node.js</h2><p>官网下载(<a href="https://nodejs.org/en/download/" target="_blank" rel="noopener">https://nodejs.org/en/download/</a>)<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tar xzf node-v4.4.6.tar.gz</span></span><br><span class="line"><span class="comment"># cd node-v4.4.6</span></span><br><span class="line"><span class="comment"># ./configure --prefix=/usr/local/node</span></span><br><span class="line"><span class="comment"># make &amp;&amp; make install</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># vim + /etc/profile</span></span><br></pre></td></tr></table></figure></p>
<p>最后增加一行<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=/usr/<span class="built_in">local</span>/mysql/bin:/usr/<span class="built_in">local</span>/php7/bin:/usr/<span class="built_in">local</span>/node/bin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure></p>
<p>立即生效<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># source /etc/profile</span></span><br></pre></td></tr></table></figure></p>
<p>安装pm2<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># npm install -g pm2</span></span><br></pre></td></tr></table></figure></p>
<p><strong> 注意：本站博文均系原创，欢迎转载，请注明出处和原网址 </strong></p>
</div><div class="tags"><a href="/tags/PHP/">PHP</a><a href="/tags/Centos7/">Centos7</a><a href="/tags/Nginx/">Nginx</a><a href="/tags/MySQL5-7/">MySQL5.7</a><a href="/tags/Redis3-2/">Redis3.2</a><a href="/tags/swoole1-8/">swoole1.8</a><a href="/tags/node-js/">node.js</a></div><div class="post-nav"><a href="/2017/02/25/How-to-make-the-node-js-application-run-stably/" class="pre">让Node.js程序稳定运行</a><a href="/2005/10/20/PHP-breakpoint-resume/" class="next">PHP 实现文件下载的断点续传</a></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="widget"><div class="widget-title"><i class="fa fa-biao"> 标签</i></div><div class="tagcloud"><a href="/tags/NW-js/" style="font-size: 15px;">NW.js</a> <a href="/tags/window-open/" style="font-size: 15px;">window.open</a> <a href="/tags/Node-js/" style="font-size: 15px;">Node.js</a> <a href="/tags/sleep/" style="font-size: 15px;">sleep</a> <a href="/tags/PHP/" style="font-size: 15px;">PHP</a> <a href="/tags/断点续传/" style="font-size: 15px;">断点续传</a> <a href="/tags/Centos7/" style="font-size: 15px;">Centos7</a> <a href="/tags/Nginx/" style="font-size: 15px;">Nginx</a> <a href="/tags/MySQL5-7/" style="font-size: 15px;">MySQL5.7</a> <a href="/tags/Redis3-2/" style="font-size: 15px;">Redis3.2</a> <a href="/tags/swoole1-8/" style="font-size: 15px;">swoole1.8</a> <a href="/tags/node-js/" style="font-size: 15px;">node.js</a> <a href="/tags/数独/" style="font-size: 15px;">数独</a> <a href="/tags/Javascript/" style="font-size: 15px;">Javascript</a> <a href="/tags/NeDB/" style="font-size: 15px;">NeDB</a> <a href="/tags/文件型数据库/" style="font-size: 15px;">文件型数据库</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-fei"> 归档</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">十月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2005/10/">十月 2005</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/10/08/NW-js填坑之window-open/">NW.js填坑之window.open</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/15/数据库NeDB文档翻译/">数据库NeDB文档翻译</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/03/02/Sudoku-solver/">数独解题器</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/26/Node-js-sleep/">Node.js实现sleep的几种办法</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/02/25/How-to-make-the-node-js-application-run-stably/">让Node.js程序稳定运行</a></li><li class="post-list-item"><a class="post-list-link" href="/2016/06/27/Centos7-Nginx-PHP7-MySQL5-7-Redis3-2-swoole1-8/">最小化安装Centos7 编译安装Nginx PHP7 MySQL5.7 Redis3.2 swoole1.8</a></li><li class="post-list-item"><a class="post-list-link" href="/2005/10/20/PHP-breakpoint-resume/">PHP 实现文件下载的断点续传</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-fei"> 捐赠</i></div><img src="/img/donate_zhifubao.jpg" width="230"><img src="/img/donate_weixin.jpg" width="230"></div></div></div></div><a id="totop" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.2.0" async></script><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">网站地图</a> |<a href="/atom.xml">订阅本站</a> |<span>联系博主：<a href="mailto:yuenshui@126.com" target="_blank" class="fa fa-email"> </a><a href="http://weibo.com/enshui/" target="_blank" class="fa fa-weibo"></a><a href="https://github.com/yuenshui" target="_blank" class="fa fa-github"> </a></span></p><p><span> Copyright &copy;<a href="/." rel="nofollow">于恩水(Mustang Yu)</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span><span><a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> Theme </a>by<a rel="nofollow" target="_blank" href="https://github.com/chaooo"> Charles.</a></span></p></div></div></div></body></html>